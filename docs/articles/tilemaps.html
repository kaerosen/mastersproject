<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Tile Maps • tilemaps</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Tile Maps">
<meta property="og:description" content="tilemaps">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tilemaps</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/tilemaps.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kaerosen/tilemaps/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Tile Maps</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/kaerosen/tilemaps/blob/master/vignettes/tilemaps.Rmd"><code>vignettes/tilemaps.Rmd</code></a></small>
      <div class="hidden name"><code>tilemaps.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">tilemaps</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sf</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">ggplot2</span>)</pre></body></html></div>
<div id="what-is-a-tile-map" class="section level1">
<h1 class="hasAnchor">
<a href="#what-is-a-tile-map" class="anchor"></a>What is a Tile Map?</h1>
<p>A tile map is a map in which each region is represented by a single tile of the same shape and size. For example, a square tile map of the United States would consist of square tiles of the same size for each state, regardless of the geographic area of each state. When creating a tile map, the goal is to arrange tiles in a manner that preserves local relationships between regions, as well as the overall shape of the original map. Using a tile map is advantageous when trying to visualize data where the importance of a region does not depend on the geographic area of the region. Tile maps prevent regions with large areas from dominating a map and prevent regions with small areas from going unnoticed. The <code>tilemaps</code> package implements an algorithm for creating tile maps that was proposed by Graham McNeill and Scott Hale in the paper <em>“Generating Tile Maps”</em> (2017). The package allows the user to generate a single tile map or many tile maps, which can be compared by using cost functions or by plotting the maps.</p>
</div>
<div id="creating-a-single-tile-map" class="section level1">
<h1 class="hasAnchor">
<a href="#creating-a-single-tile-map" class="anchor"></a>Creating a Single Tile Map</h1>
<p>To create a single tile map, the <code><a href="../reference/generate_map.html">generate_map()</a></code> function can be used. In the following example, a tile map with flat-topped hexagons is generated for the contiguous United States using the <code>governors</code> dataset, which is part of the <code>tilemaps</code> package.</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">governors</span> <span class="kw">&lt;-</span> <span class="no">governors</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">tile_map</span> <span class="kw">=</span> <span class="fu"><a href="../reference/generate_map.html">generate_map</a></span>(<span class="no">geometry</span>, <span class="kw">square</span> <span class="kw">=</span> <span class="fl">FALSE</span>, <span class="kw">flat_topped</span> <span class="kw">=</span> <span class="fl">TRUE</span>))

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">governors</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">geometry</span> <span class="kw">=</span> <span class="no">tile_map</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">geometry</span> <span class="kw">=</span> <span class="no">tile_map</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="no">abbreviation</span>),
               <span class="kw">fun.geometry</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/pkg/sf/man/geos_unary.html">st_centroid</a></span>(<span class="no">x</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>()</pre></body></html></div>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-2-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The <code><a href="../reference/generate_map.html">generate_map()</a></code> function requires an object of class <code>sfc_POLYGON</code> or <code>sfc_MULTIPOLYGON</code> as input. If the coordinates of the <code>sfc</code> object are in terms of longitude and latitude, the coordinates will need to be transformed to a planar projection before creating the tile map. The <code>square</code> argument controls whether the tiles are squares or hexagons, and the <code>flat_topped</code> argument controls whether or not hexagons are flat-topped.</p>
<p>The <code><a href="../reference/generate_map.html">generate_map()</a></code> function only works for contiguous regions. However, after a tile map has been generated, the <code><a href="../reference/create_island.html">create_island()</a></code> function can be used to add islands to the layout of the tile map. The <code><a href="../reference/create_island.html">create_island()</a></code> function takes two arguments. The first is an <code>sfc_POLYGON</code> object representing the layout of a tile map, and the second is the position of the new island tile. The <code>position</code> argument can be specified as either a numeric vector of length 2 giving the coordinates for the centroid of the new tile, or a string equal to “upper left”, “lower left”, “upper right”, or “lower right” indicating in which corner of the original tile map the new tile should be located. In the following example, tiles for Alaska and Hawaii are added to the previously generated tile map.</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">all_states</span> <span class="kw">&lt;-</span> <span class="no">governors</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">add_row</a></span>(<span class="kw">abbreviation</span> <span class="kw">=</span> <span class="st">"AK"</span>, <span class="kw">party</span> <span class="kw">=</span> <span class="st">"Republican"</span>,
          <span class="kw">tile_map</span> <span class="kw">=</span> <span class="fu"><a href="../reference/create_island.html">create_island</a></span>(<span class="no">governors</span>$<span class="no">tile_map</span>, <span class="st">"lower left"</span>)) <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/reexports.html">add_row</a></span>(<span class="kw">abbreviation</span> <span class="kw">=</span> <span class="st">"HI"</span>, <span class="kw">party</span> <span class="kw">=</span> <span class="st">"Democrat"</span>,
          <span class="kw">tile_map</span> <span class="kw">=</span> <span class="fu"><a href="../reference/create_island.html">create_island</a></span>(<span class="no">governors</span>$<span class="no">tile_map</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(-<span class="fl">12050000</span>, <span class="fl">3008338</span>)))

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">all_states</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">geometry</span> <span class="kw">=</span> <span class="no">tile_map</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">geometry</span> <span class="kw">=</span> <span class="no">tile_map</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="no">abbreviation</span>),
               <span class="kw">fun.geometry</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/pkg/sf/man/geos_unary.html">st_centroid</a></span>(<span class="no">x</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>()</pre></body></html></div>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-3-1.png" width="384" style="display: block; margin: auto;"></p>
<p>Once a tile map has been created, coloring tiles according to another variable is simple. In the following code, the states are colored according to the party affiliation of the governor. This is an example of a situation where it is useful to use a tile map, instead of a regular map, because each state has only one governor, regardless of the area or population of the state.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">all_states</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">geometry</span> <span class="kw">=</span> <span class="no">tile_map</span>, <span class="kw">fill</span> <span class="kw">=</span> <span class="no">party</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">geometry</span> <span class="kw">=</span> <span class="no">tile_map</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="no">abbreviation</span>),
               <span class="kw">fun.geometry</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">x</span>) <span class="fu"><a href="https://rdrr.io/pkg/sf/man/geos_unary.html">st_centroid</a></span>(<span class="no">x</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_brewer.html">scale_fill_brewer</a></span>(<span class="kw">palette</span> <span class="kw">=</span> <span class="st">"Set1"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">ggtitle</a></span>(<span class="st">"Party Affiliation of United States Governors (2020)"</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>()</pre></body></html></div>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-5-1.png" width="528" style="display: block; margin: auto;"></p>
<p>The layout of a tile map can easily be written to a shapefile for later use or to share with others as follows.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/pkg/sf/man/st_write.html">st_write</a></span>(<span class="no">governors</span>$<span class="no">tile_map</span>, <span class="st">"us_tilemap.shp"</span>)</pre></body></html></div>
</div>
<div id="creating-many-tile-maps" class="section level1">
<h1 class="hasAnchor">
<a href="#creating-many-tile-maps" class="anchor"></a>Creating Many Tile Maps</h1>
<p>To create and compare more than one tile map, the <code><a href="../reference/many_maps.html">many_maps()</a></code> function can be used. In the following example, 16 candidate tile maps are generated and plotted.</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">us_maps</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/many_maps.html">many_maps</a></span>(<span class="no">governors</span>$<span class="no">geometry</span>, <span class="no">governors</span>$<span class="no">abbreviation</span>,
                     <span class="kw">prop</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">0.1</span>), <span class="kw">interpolate</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0.5</span>, <span class="fl">1</span>),
                     <span class="kw">smoothness</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fl">20</span>), <span class="kw">shift</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0</span>), <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">0.5</span>)))</pre></body></html></div>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;"></p>
<p>The different candidate tile maps are generated by adding sources of variation at different steps in the algorithm. The <code>prop</code>, <code>interpolate</code>, <code>smoothness</code>, and <code>shift</code> arguments control these sources of variation and will be discussed in more detail later. The total number of maps generated by the <code><a href="../reference/many_maps.html">many_maps()</a></code> function is the product of the lengths of each of these arguments. The output of the <code><a href="../reference/many_maps.html">many_maps()</a></code> function is a data frame in which each row corresponds to one map and the columns contain the generated maps, the parameters used for creating the maps, and the costs associated with each map. The data frame is ordered by the total cost. The different types of costs will be discussed in more detail later as well. After comparing the tile maps that were generated, the tile map that the user wishes to use can be added to the original data frame and plotted.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">governors</span> <span class="kw">&lt;-</span> <span class="no">governors</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span>(<span class="kw">square_map</span> <span class="kw">=</span> <span class="no">us_maps</span>$<span class="no">map</span><span class="kw">[[</span><span class="fl">1</span>]])

<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span>(<span class="no">governors</span>) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">geometry</span> <span class="kw">=</span> <span class="no">square_map</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsf.html">geom_sf_text</a></span>(<span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="kw">geometry</span> <span class="kw">=</span> <span class="no">square_map</span>, <span class="kw">label</span> <span class="kw">=</span> <span class="no">abbreviation</span>)) +
  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_void</a></span>()</pre></body></html></div>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-8-1.png" width="384" style="display: block; margin: auto;"></p>
<p>The plot of all the candidates maps shown above can be generated using the <code><a href="../reference/plot_many_maps.html">plot_many_maps()</a></code> function. The function requires a list of maps, which are of class <code>sfc_POLYGON</code>, and the labels for the regions of the map. Below is code for how the <code><a href="../reference/plot_many_maps.html">plot_many_maps()</a></code> function can be used to create the same plot as before.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="../reference/plot_many_maps.html">plot_many_maps</a></span>(<span class="no">us_maps</span>$<span class="no">map</span>, <span class="no">governors</span>$<span class="no">abbreviation</span>)</pre></body></html></div>
</div>
<div id="the-algorithm" class="section level1">
<h1 class="hasAnchor">
<a href="#the-algorithm" class="anchor"></a>The Algorithm</h1>
<p>The four main steps of the algorithm used to generate a tile map are transforming the region centroids, transforming the boundary, fitting tiles to the boundary, and assigning regions to tiles. The <code>prop</code>, <code>interpolate</code>, <code>smoothness</code>, and <code>shift</code> arguments of the <code><a href="../reference/generate_map.html">generate_map()</a></code> and <code><a href="../reference/many_maps.html">many_maps()</a></code> functions are used to introduce variation at different steps in the algorithm, which can lead to different candidate maps. How each step of the algorithm works and how variation is introduced will now be discussed in greater detail.</p>
<div id="transforming-the-centroids" class="section level2">
<h2 class="hasAnchor">
<a href="#transforming-the-centroids" class="anchor"></a>Transforming the Centroids</h2>
<p>The first step of the algorithm is to transform the region centroids so that centroids of neighboring regions are approximately equidistant but the relative orientation of neighbors is still preserved. The <code>prop</code> argument can be used at this step of the algorithm to add variation. Before transforming the original region centroids, Gaussian noise is added to the position of each centroid. The standard deviation for the Gaussian noise is defined as a proportion of the mean distance of a region centroid to its neighbor centroids, and the <code>prop</code> argument is used to control this proportion. After noise has been added to the centroids, the centroids are iteratively updated until they converge. The formula used to update the noisy centroids is given by McNeill and Hale in <em>“Generating Tile Maps”</em> (2017).</p>
<p>Before moving to the next step of the algorithm, another source of variation can be added. Throughout the remaining steps of the algorithm the fully-transformed centroids can be used, or interpolated centroids can be used. The interpolated centroids are defined through linear interpolation between the noisy centroids and fully-transformed centroids. If straight lines were drawn between the noisy centroids and fully-transformed centroids, then the interpolated centroids would be the points at a specified proportion of the distances along the lines. The <code>interpolate</code> argument controls the proportion. If the <code>interpolate</code> argument is set equal to 0, then the noisy centroids would be used in the remaining steps of the algorithm, and if the <code>interpolate</code> argument is set equal to 1, then the fully-transformed centroids would be used. If the <code>interpolate</code> argument is set equal to 0.75, then the points that are at 75% of the distance between the noisy centroids and fully-transformed centroids would be used.</p>
<p>Using the same United States dataset as before, the plot below shows the noisy, interpolated, and fully-transformed centroids when the <code>prop</code> argument was set equal to 0.1, and the <code>interpolate</code> argument was set equal to 0.75. Notice that in the plot the centroids of states in the northeast are being pushed out, while centroids of states on the west coast are being pulled toward the center of the map. This results in the centroids of neighboring states being approximately equidistant. Throughout the remaining steps of the algorithm, the interpolated centroids will be used.</p>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-10-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="transforming-the-boundary" class="section level2">
<h2 class="hasAnchor">
<a href="#transforming-the-boundary" class="anchor"></a>Transforming the Boundary</h2>
<p>The next step of the algorithm is to transform the boundary of the map based on the new centroids. The boundary is pulled in toward the new centroids if the boundary is more than the estimated tile size away from the centroids, and the boundary is pushed away from the new centroids if the boundary is less than the estimated tile size away from the centroids. At this step, the boundary of the map is first converted to a set of points, and then a sample of approximately 1,000 points is taken from that set. The sampled boundary points are transformed according to the formula given in <em>“Generating Tile Maps”</em> (McNeill and Hale 2017). After the sample boundary points have been transformed, they are then converted to a polygon. To introduce variation at this step in the algorithm, the transformed boundary can be smoothed. The <code><a href="https://rdrr.io/r/stats/smooth.html">smooth()</a></code> function from the <code>smoothr</code> package is used to perform kernel smoothing of the boundary. How much the boundary is smoothed is controlled by the <code>smoothness</code> argument. The <code><a href="https://rdrr.io/r/stats/smooth.html">smooth()</a></code> function calculates the bandwidth of the Gaussian kernel used for smoothing as the mean distance between adjacent points, and the bandwidth is then multiplied by the value given for the <code>smoothness</code> argument. The greater the value of the <code>smoothness</code> argument, the more smooth the boundary will become. Below is a plot with the transformed and smoothed boundaries of the United States with the <code>smoothness</code> argument set equal to 20. Notice that the transformed boundary is now outside the original boundary around the northeast and the transformed boundary is within the original boundary along the west coast. For the remaining steps of the algorithm, the smoothed boundary will be used.</p>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-11-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="fitting-tiles-to-the-boundary" class="section level2">
<h2 class="hasAnchor">
<a href="#fitting-tiles-to-the-boundary" class="anchor"></a>Fitting Tiles to the Boundary</h2>
<p>The third step of the algorithm is to fit tiles inside the transformed boundary. This is done by first creating a grid of tiles that covers the bounding box of the transformed polygon. The size of the tiles is estimated by first finding the total area of the map, dividing it by the number of regions, and then taking the square root. After creating the initial grid, the number of tile centroids that are inside the transformed boundary is found. Depending on whether the number of tile centroids inside the boundary is greater than or less than the number of regions in the map, the tile size is either increased or decreased, and then a new grid of tiles is created. This process is repeated until the correct number of tile centroids are within the transformed boundary. Variation can also be added at this step by shifting the grid of tiles before counting the number of tile centroids that lie within the transformed boundary. The <code>shift</code> argument is a numeric vector of length two for the <code><a href="../reference/generate_map.html">generate_map()</a></code> function or a list of numeric vectors of length two for the <code><a href="../reference/many_maps.html">many_maps()</a></code> function. The first value of the vector determines the amount to shift in the x direction and the second value determines the amount to shift in the y direction. The values given in the vector are multiplied by the tile size, and the resulting value is the amount that the grid is shifted. For example if <code><a href="https://rdrr.io/r/base/c.html">c(0.5,0.5)</a></code> was given for the shift argument in the <code><a href="../reference/generate_map.html">generate_map()</a></code> function, then the grid of tiles would be shifted by half a tile in both the x and y directions. In the final step of the algorithm, a square grid, which was shifted by half a tile in each direction, will be used.</p>
</div>
<div id="assigning-regions-to-tiles" class="section level2">
<h2 class="hasAnchor">
<a href="#assigning-regions-to-tiles" class="anchor"></a>Assigning Regions to Tiles</h2>
<p>To complete the tile map, the regions of the original map must be assigned to the tiles of the tile map. The assignment of regions to tiles is chosen to minimize the sum of the squared distances between transformed region centroids and the assigned tile centroids. This an example of the well-known linear sum assignment problem. This problem can be solved using an algorithm known as the Hungarian method, which was first developed by Harold Kuhn (1955). A plot of the resulting tile map is shown below.</p>
<p><img src="tilemaps_files/figure-html/unnamed-chunk-13-1.png" width="384" style="display: block; margin: auto;"></p>
</div>
<div id="calculating-costs" class="section level2">
<h2 class="hasAnchor">
<a href="#calculating-costs" class="anchor"></a>Calculating Costs</h2>
<p>In <em>“Generating Tile Maps”</em> (2017), McNeill and Hale describe four different cost functions that can be used to compare tile maps. The first is a location cost, which is the mean distance between the transformed centroids and tile centroids divided by the tile size. The next cost is an adjacency cost, which is the mean of the proportion of neighbors that each region is missing. The relative orientation cost is a measure of how much the angles between centroids of neighboring regions change. First the mean change in angles between a region centroid and its neighboring centroids is found for each region. Then the final relative orientation cost is the mean of the means of the regions. The final cost is a roughness cost. This cost is based on how many edges in the tile map are shared edges. These four costs can be combined into one total cost as a weighted sum. The data frame output by the <code><a href="../reference/many_maps.html">many_maps()</a></code> function includes columns for each of the costs, and the <code>weights</code> argument can be used to control the weight for each cost when calculating the total cost.</p>
</div>
</div>
<div id="references" class="section level1">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<p>Kuhn, Harold W. 1955. “The Hungarian Method for the Assignment Problem.” <em>Naval Research Logistics Quarterly</em> 2 (1-2). Wiley Online Library: 83–97.</p>
<p>McNeill, Graham, and Scott A Hale. 2017. “Generating Tile Maps.” In <em>Computer Graphics Forum</em>, 36:435–45. 3. Wiley Online Library.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kaelyn Rosenberg.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
